{% extends "base.html" %}
{% block title %}{{ type }}{% endblock %}
{% block content %}
<div style="max-width: 500px; margin: auto;">
    <div class="form-box">
        <h2>{{ type }} Amount</h2>
        <form action="{{ url_for('transaction', type=type.lower()) }}" method="post">
            <div class="form-group">
                <label for="amount">Amount (INR)</label>
                <input type="number" id="amount" name="amount" min="1" {% if type == 'Deposit' %}max="100000"{% endif %} step="0.01" required>
            </div>
            
            {% if type == 'Withdraw' %}
            <div class="form-group">
                 <button type="button" onclick="checkBalance()" class="btn btn-primary" style="background-color: #6c757d;">View Account Balance</button>
                 <p id="balance-display" style="text-align: center; margin-top: 10px; font-weight: bold;"></p>
            </div>
            {% endif %}

            <button type="submit" class="btn btn-primary">Submit {{ type }}</button>
        </form>
         <a href="{{ url_for('customer_dashboard') }}" style="text-decoration: none; display:block; margin-top: 1rem;"><button class="btn btn-primary" style="background-color:#aaa;">Back to Dashboard</button></a>
    </div>
</div>
{% endblock %}

{% block scripts %}
{% if type == 'Withdraw' %}
<script>
    function checkBalance() {
        fetch('{{ url_for('get_balance') }}')
            .then(response => response.json())
            .then(data => {
                if(data.balance) {
                    document.getElementById('balance-display').innerText = `Available Balance: ${data.balance}`;
                } else {
                    document.getElementById('balance-display').innerText = 'Could not fetch balance.';
                }
            });
    }
</script>
{% endif %}
{% endblock %}